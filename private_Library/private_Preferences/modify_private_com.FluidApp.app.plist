#!/bin/bash
# Selectively configure FluidApp preferences.
# Only sets portable preferences â€” device-specific values (audio UIDs, window
# geometry, chat history, timestamps) are left untouched.
# shellcheck source=.plist_common.sh
source "$CHEZMOI_SOURCE_DIR/private_Library/private_Preferences/.plist_common.sh"

# --- General ---
set_bool   AutoUpdateCheckEnabled              false
set_bool   EnableAIProcessing                  true
set_bool   LaunchAtStartup                     true
set_bool   ShareAnonymousAnalytics             false

# --- Voice ---
set_string SelectedProviderID                  apple-intelligence
set_string SelectedSpeechModel                 parakeet-tdt
set_bool   PressAndHoldMode                    false
set_bool   RemoveFillerWordsEnabled            false
set_bool   SaveTranscriptionHistory            true

# --- Hotkeys ---
# keyCode = macOS virtual key code, modifierFlagsRawValue = modifier bitmask
# keyCode 2 = D, modifiers 1835008 = Cmd+Option+Ctrl (0x1C0100)
set_data_json HotkeyShortcutKey '{"keyCode":2,"modifierFlagsRawValue":1835008}'

# --- Overlay ---
set_string OverlayPosition                     bottom
set_string OverlaySize                         large

# --- AI command/rewrite modes ---
set_string CommandModeSelectedModel             gpt-4.1
set_bool   CommandModeShortcutEnabled           false
set_string RewriteModeSelectedModel             gpt-4.1
set_bool   RewriteModeShortcutEnabled           false

# Left untouched (device/session-specific):
# AXLastPromptAt, AnalyticsAnonymousInstallID, AnalyticsFirstOpenAt
# AvailableModelsByProvider, SelectedModelByProvider
# CommandModeChatSessions, CommandModeCurrentChatID
# CommandModeHotkeyShortcut (binary hotkey data)
# FluidVoice_Accessibility*, PlaygroundUsed (internal state flags)
# LastUpdateCheckDate
# NSSplitView/NSStatusItem/NSWindow Frame (window geometry)
# PreferredInputDeviceUID, PreferredOutputDeviceUID (audio device serials)

plist_finalize
