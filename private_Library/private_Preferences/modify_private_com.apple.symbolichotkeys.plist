#!/bin/bash
# Configure macOS symbolic hotkeys: disable nearly all, enable a select few.
#
# Instead of calling PlistBuddy per-hotkey (~275 calls, ~750ms), we replace the
# entire AppleSymbolicHotKeys dict with a single plutil -insert -json (~14ms).
#
# Enabled hotkeys:
#   31:  Cmd+Shift+1  — screenshot to file
#
# Everything else is disabled. Hotkey IDs not listed here are left to system
# defaults (we don't touch keys we haven't audited).

# shellcheck source=.plist_common.sh
source "$CHEZMOI_SOURCE_DIR/private_Library/private_Preferences/.plist_common.sh"

# Build the complete hotkey dict as JSON.
# Disabled entries only need {"enabled": false} — macOS populates the value
# dict when re-enabled via System Settings.
hotkeys='{'

# Disabled hotkeys (grouped by category for readability)
for k in \
    7 8 9 10 11 12 13 \
    15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \
    32 33 36 52 53 54 57 59 60 61 64 65 79 80 81 82 98 \
    118 159 162 164 175 184 190 \
    215 216 217 218 219 222 223 224 225 226 227 228 229 \
    230 231 232 233 235 237 238 239 \
    240 241 242 243 244 245 246 247 248 249 \
    250 251 256 257 258 260; do
    hotkeys+="\"$k\":{\"enabled\":false},"
done

# Enabled hotkeys with their key bindings
hotkeys+='"31":{"enabled":true,"value":{"type":"standard","parameters":[49,18,1179648]}}'

hotkeys+='}'

plutil -remove AppleSymbolicHotKeys "$tmp" 2>/dev/null || true
plutil -insert AppleSymbolicHotKeys -json "$hotkeys" "$tmp"

plist_finalize
